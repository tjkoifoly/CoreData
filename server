#!/usr/bin/env python

import BaseHTTPServer
import urlparse
import datetime
import random
import json
import os
import re

SENDERS = [ "mail", "info", "news", "deals", "noreply", ]
SUBJECTS = [ "%(companyname)s Sales & Marketing Newsletter", "Eye on the %(companyname)s Update (Oct 31 - Nov 4)", "%(companyname)s Staff Shirts & Photos", "%(companyname)s May 2005 News Bulletin!", "%(companyname)s Newsletter - February 2006", "%(companyname)s Newsletter - January 2006 [ *|FNAME|* *|LNAME|* ]", "%(companyname)s and %(companyname)s Invites You!", "Happy Holidays from %(companyname)s", "ATTENTION %(companyname)s Staff!", "ATTENTION %(companyname)s West Staff!!", "Invitation from %(companyname)s", "%(companyname)s Jan/Feb 2006 Newsletter", "Website news - Issue 3", "Upcoming Events at %(companyname)s", "%(companyname)s Councils: Letter of Interest", "%(companyname)s Coffee Exchange - Post-Katrina Update", "We're Throwing a Party", "October 2005 Newsletter", "%(companyname)s: 02.10.06", "%(companyname)s Racing Newsletter", "Last Minute Gift - We Have The Answer", "Valentines - Shop Early & Save 10%%", "Give a Gift Certificate this Holiday", "Valentine's Day Salon and Spa Specials!", "Gift Certificates - Easy & Elegant Giving - Let Them Choose", "Need More Advertising Value From Your Marketing Partner?", "%(companyname)s Pioneers in Banana Technology", "%(companyname)s Moves You Home for the Holidays", "Renewal", "Technology Company Works with %(companyname)s on Bananas Efforts", "%(companyname)s Update - A Summary of Security and Emergency Preparedness News", "Now Offering Banana Services!", "It's still summer in Tahoe!", "%(companyname)s endorses %(companyname)s as successor", "%(companyname)s Holiday Sales Event", "The Future of International Trade", "%(companyname)s for your next dream home.", "True automation of your Banana Research", "%(companyname)s Resort - Spring into May Savings", "You Asked For More...", ]
COMPANIES = [ "2K Games", "24 Hour Fitness", "3M", "4Kids Entertainment", "a21, Inc.", "Aaron's, Inc.", "Abbott Laboratories", "Abercrombie & Fitch", "ABM Industries", "ABX Air", "AC Lens", "Access Systems Americas, Inc.", "ACCO Brands", "Accuquote", "Ace Hardware", "Acme Brick", "ACN Inc.", "Activision Blizzard", "Acuity Brands", "ADC Telecommunications", "Adaptec", "Adobe Systems", "Advance Auto Parts", "Advanced Micro Devices", "Advanced Processing & Imaging", "AECOM", "Aeropostale", "AES Corporation", "Aetna", "Affiliated Computer Services", "Aflac", "AGCO", "Agilent Technologies", "AGL Resources", "Agriprocessors", "Air Products & Chemicals", "Airgas", "AirTran Holdings", "AK Steel Holding", "Alaska Air Group", "Albemarle Corporation", "Albertsons LLC", "Alcoa", "Aleris", "Alexander & Baldwin", "Alienware", "Allegheny Energy", "Allegheny Technologies", "Allen Organ Company", "Allergan", "Alliant Energy", "Alliant Techsystems", "Allstate", "Altec Lansing", "Altria (formerly Philip Morris Companies)", "Always (product)", "Amazon.com", "AMC Entertainment", "Advanced Micro Devices", "Ameren", "American Axle", "American Apparel", "American Broadcasting Company", "American Eagle Outfitters", "American Electric Power", "American Express", "American Family Insurance", "American Financial Group", "American Greetings", "American Home Mortgage", "American International Group", "American Reprographics Company", "Amerigroup", "Ameriprise Financial", "AmerisourceBergen", "Ametek", "Amgen", "Amkor Technology", "Amphenol", "AMR Corporation", "American Airlines", "Amtrak (National Railroad Passenger Corporation)", "Amy's Kitchen", "Anadarko Petroleum Corporation", "Analog Devices", "AnaSpec", "Anchor Bay Entertainment", "AND1", "Anixter", "Ann Taylor", "Antec", "AOL", "Aon plc", "Apache Software Foundation", "Apollo Group", "Applebee's", "Apple Inc.", "Applied Biosystems", "Applied Industrial Technologies", "Applied Materials", "Aramark", "Arbitron", "Arch Coal", "Archer Daniels Midland", "Arc Machines", "Arctic Cat", "Ariba", "Arizona Stock Exchange", "Arkeia Software", "Armstrong World Industries", "Arrow Electronics", "Arryx", "ASARCO (American Smelting And Refining Company)", "Asbury Automotive Group", "Ashland Inc.", "AskMeNow", "Aspyr Media", "Assurant", "Atmos Energy", "AT&T", "AT&T Mobility", "Audiovox", "Atari", "Autodesk", "Autoliv", "Automatic Data Processing", "AutoNation", "Auto-Owners Insurance", "AutoZone", "Avaya", "Avery Dennison", "Avis Budget Group", "Avnet", "Avon Products", "AVST", "Babcock & Wilcox", "Bain & Company", "Bain Capital", "Baker Hughes", "Baldor Electric Company", "Ball Corp.", "Bank of America", "Bank of New York Mellon", "Barnes & Noble", "Bath & Body Works", "Baxter International", "Bebo", "BB&T Corporation", "BE Aerospace", "Bealls", "BearingPoint", "Beazer Homes USA", "Bechtel", "Beckman Coulter", "Becton Dickinson", "Bed Bath & Beyond", "Belk", "Belkin", "Bellwether Technology Corporation", "Bemis Manufacturing Company", "Benchmark Electronics", "W. R. Berkley", "Berkshire Hathaway", "Berry Plastics", "Best Buy", "BFG Technologies", "Big Lots", "Biggby Coffee", "Bio-Rad Laboratories", "Biomet", "Birdwell", "BJ Services Company", "BJ's Wholesale Club", "Black & Decker", "BlackRock", "Blockbuster LLC", "BlueLinx Holdings", "Blyth, Inc.", "BMC Software", "BNSF Railway", "Bob Evans Restaurants", "Boeing", "Boise Cascade", "Borders Group", "BorgWarner", "Bosch Brewing Company", "Bose Corporation", "Boston Acoustics", "Boston Scientific", "Boyd Gaming", "Bradley Pharmaceuticals", "Briggs & Stratton", "Brightpoint", "Brinker International", "Brink's", "Bristol-Myers Squibb", "Broadcom", "Brookdale Senior Living", "Brown-Forman", "Brunswick Corporation", "Bucyrus International", "Burger King Holdings", "Burlington Coat Factory", "Bushmaster Firearms International", "CA Technologies", "Calista Corporation", "Calpine", "Capital One", "Carnival Corporation & plc", "Carnival Cruise Lines", "Cartoon Network Studios", "Casco Bay Lines", "Caterpillar Inc.", "CBS Corporation", "CDI Corporation", "Cerner", "C. H. Robinson Worldwide", "Chem-Dry", "Chevron Corporation", "ChexSystems", "Chicago Bridge & Iron Company", "Chugach Alaska Corporation", "Chrysler", "CIGNA", "Cisco Systems", "Citigroup", "Citrix Systems", "CKE Restaurants", "Clear Channel Communications", "CNA Financial", "CNET", "The Coca-Cola Company", "Cogent Communications", "Cognizant Technology Solutions", "Cole Haan", "Colgate-Palmolive", "Colt Defense", "Colt's Manufacturing Company", "Columbia Pictures", "Columbia Sussex", "Comcast", "Comodo", "ConocoPhillips", "Conseco", "Control Data Corporation (CDC)", "Convergys", "Converse", "CoolTouch Monitors", "Copeland's", "Corning Inc.", "Corsair Memory", "Costco", "Coventry Health Care", "Cray", "Crazy Eddie", "Crowley Maritime", "CVS Pharmacy", "Danaher", "Darden Restaurants", "DaVita", "DC Comics", "DC Shoes", "Dean Foods", "Deere & Company", "Del Monte Foods", "Dell", "Delphi", "Delta Air Lines", "Devon Energy", "DEX One", "Dick's Sporting Goods", "DiC Entertainment", "Diebold", "Digi-Key", "Dillard's", "DineEquity", "Dippin' Dots", "DirecTV", "Discover Financial", "Discovery Communications", "Dish Network", "The Walt Disney Company", "DivX, Inc.", "Djarum", "Doculabs", "Dole Food Company", "Dollar General", "Dollar Tree", "Dominion Resources", "Domtar", "Dover Corporation", "Dow Chemical Company", "Dow Jones & Company", "Dr Pepper Snapple Group", "Dresser Industries", "DRS Technologies", "DST Systems", "DTE Energy", "Duke Energy", "Dun & Bradstreet", "DuPont (E.I. du Pont de Nemours)", "DynCorp", "Dynegy", "Eastman Chemical Company", "Eastman Kodak", "eBay", "Ecolab", "Eddie Bauer", "El Paso Corp.", "Electronic Arts", "Electronic Data Systems", "Eli Lilly and Company", "Elizabeth Arden", "EMC Corporation", "Emcor", "Emerson Electric Company", "Emerson Radio", "Energizer Holdings", "Enterasys Networks", "Entergy", "Enterprise GP Holdings", "Equifax", "Erie Insurance Group", "Esselte", "Estee Lauder Companies", "Eureka", "Exelon", "Expeditors International", "Express Scripts", "ExxonMobil", "Fabrik Inc.", "Facebook", "Fairchild Semiconductor", "Fannie Mae (Federal National Mortgage Association)", "FedEx", "Fender Musical Instruments Corporation", "Fidelity Investments", "FileMaker Inc., formerly Claris Corp.", "Firestone Tire and Rubber Company", "First Hawaiian Bank", "Fiserv", "Fisher Electronics", "Fisker Automotive", "Fluor Corporation", "Ford Motor Company", "Forum Communications", "Fox Entertainment Group", "Frasca International", "Fred Meyer", "Freddie Mac (Federal Home Loan Mortgage Corporation)", "FreeWave Technologies", "Fresh & Easy", "Frontier Airlines", "Fruit of the Loom", "Gap", "Garmin", "Gartner", "Gateway, Inc.", "Gatorade", "GCI", "GEICO", "Gemini Sound Products", "Generac Power Systems", "General Dynamics", "General Dynamics Electric Boat", "General Electric", "GE Consumer & Industrial", "General Mills", "General Motors", "Gentiva Health Services", "Georgia-Pacific", "GHD Group", "Giant Food", "Gibson Guitar Corporation", "Gillette", "Global Insight", "Go Daddy", "Goldman Sachs", "Goodrich Corporation", "Goodyear Tire and Rubber Company", "Google", "Ground Round", "Group O", "Growmark", "GTECH", "H&R Block", "Hallmark Cards", "Halliburton", "Hardee's", "Harley-Davidson", "Harman International Industries", "Hasbro", "Hastings Entertainment", "Hawaiian Airlines", "H-E-B", "The Hertz Corporation", "Hewlett-Packard", "Hi-Point Firearms", "Hilton Worldwide", "H. J. Heinz Company", "Home City Ice", "The Home Depot", "Honeywell", "Hornbeck Offshore Services", "Hot Topic", "Houchens Industries", "Houghton Mifflin Harcourt Learning Technology", "Houlihan's", "House of Dereon", "Human Kinetics", "Hunt Petroleum", "Hyland Software", "Iberdrola USA", "IBM", "Ideal Industries", "Imation", "Infor Global Solutions", "Intel", "Intercontinental Manufacturing Company", "International Game Technology (IGT)", "International Paper", "Interplay Entertainment", "Interstate Batteries", "Intuit", "ION Media Networks", "iRobot", "Iron Mountain Incorporated", "Jack in the Box", "Jarden", "J. C. Penney", "JetBlue Airways", "Jimmy John's", "JL Audio", "JN-International Medical Corporation", "Jobing.com", "Jones Soda", "Johnson & Johnson", "Johnson Controls", "Journal Communications", "JPMorgan Chase", "KBR", "KFC", "Kellogg Company", "Kenexa", "Kenworth", "Kerr-McGee", "Kimberly-Clark", "Kingston Technology", "Klipsch Audio Technologies", "Kmart", "Koch Industries", "Kohler Company", "KPMG", "Kraft Foods", "Kroger", "Kurzweil Educational Systems", "Laserfiche", "LeapFrog Enterprises", "Lennox International", "Lexmark", "The Liberty Corporation", "Liberty Mutual", "Limited Brands", "LinkedIn", "Liz Claiborne", "Lowe's", "L.L.Bean", "L&L Hawaiian Barbecue", "Local Matters", "Lockheed Martin", "Louisiana-Pacific", "Lucas Oil", "Lucasfilm", "Lumencraft", "Magnavox", "Marantz", "Marathon Oil", "Marriott Corporation", "Mars, Incorporated", "Marsh & McLennan Companies", "Marshall Pottery", "Martha Stewart Living Omnimedia", "Martin Marietta Materials", "MasterCard", "Mattel", "Mauna Loa Macadamia Nut Corporation", "Maxtor", "McCormick & Company", "McDonald's", "MCI Inc.", "McIlhenny Company", "Medimix International", "Meijer", "Memorex", "Merck & Co.", "Mercury Marine", "Meritor", "Microsoft", "Midway Games", "Midwest Communications", "MIG, Inc.", "Miller Brewing Company", "Miro Technologies", "Monsanto", "Morgan Stanley", "Motorola", "Mozilla Foundation", "MTX Audio", "Musco Lighting", "Mutual of Omaha", "Myspace", "Nabisco", "Nalge Nunc International", "National Railway Equipment Company", "Nationwide Mutual Insurance Company", "NBCUniversal", "NCR Corporation", "NetApp", "Netcordia", "NetDNA", "Netflix", "Netgear", "NetZero", "New Balance", "New Era Tickets", "News Corporation", "Nike, Inc.", "Nordstrom", "Northrop Grumman", "Northwest Airlines", "Novell", "Novellus Systems", "Numark Industries", "Nvidia", "Oberweis Dairy", "Ocean Spray", "OCZ Technology", "Office Depot", "OfficeMax", "Olan Mills", "The Omni Group", "Omnicare", "ONEOK", "Onvia", "Open Interface North America", "OpenMarket Inc.", "Opower", "Oracle Corporation", "Oracle Financial Services Software", "Oreck Corporation", "O'Reilly Auto Parts", "OSI Restaurant Partners", "Overcast Media", "Owens Corning", "Owens-Illinois", "PACCAR", "Pacific Gas and Electric Company (PG&E)", "Pantone", "Papa John's Pizza", "Paramount Pictures", "Paxton Media Group", "Payless ShoeSource", "PC Power and Cooling", "PepsiCo", "Perdue Farms", "Peterbilt", "Pier 1 Imports", "Pilgrim's Pride", "Pinnacle Systems", "Pizza Hut", "Pfizer", "Plochman's", "Polaroid Corporation", "Polaris Industries", "Popeyes Chicken & Biscuits", "Precision Castparts Corp.", "PricewaterhouseCoopers", "Principal Financial Group", "Procter & Gamble", "Progressive Corporation", "Publix", "QCR Holdings", "Qpass", "Qualcomm", "Quanta Services", "Quantrix", "Quest Software", "Quincy Newspapers", "QVC", "Qwest", "Quiznos", "RadioShack", "Raytheon", "Rayovac", "RCA", "Red Hat", "Red River Broadcasting", "Rent-a-Wreck", "Renys", "Regis Corporation", "Respironics", "Rite Aid", "Rockford Fosgate", "Rockstar Games", "Rockwell Automation", "Rockwell Collins", "Rollins Inc.", "Royal Caribbean International", "RR Donnelley", "Russell Investments", "Russell Stover Candies", "Ryder", "S3 Graphics", "Safeco", "Safeway Inc.", "Salem Communications", "SanDisk", "Sauer-Danfoss", "Schoep's Ice Cream", "SAIC", "Seagate Technology", "Sears", "Seattle's Best Coffee", "Service Corporation International (SCI)", "Sequoia Voting Systems", "SFN Group", "Shirokiya", "Shure", "Six Flags", "Silicon Graphics", "Silicon Image", "SkyWest Airlines", "Snap-on", "Sonic Solutions", "Sony Pictures Entertainment", "Southern California Edison", "Southwest Airlines", "Soyo Group", "Spanx", "Springfield Armory, Inc.", "Sprint Nextel", "Spectrum Brands", "Staples Inc.", "Starbucks", "Starz", "State Street Corporation", "Steinway & Sons", "Sterling Ledet & Associates", "Stewart-Warner", "Storage Technology Corporation", "STX", "Subway", "Sunny Delight Beverages", "Sunoco", "SuperValu", "Sur La Table", "Syntel", "Symantec", "Take-Two Interactive", "Tanadgusix Corporation", "Target Corporation", "Tempur-Pedic", "Tesla Motors", "Tesoro", "Testor Corporation", "Texas Instruments", "Textron", "The Library Corporation (TLC)", "THQ", "Time Warner Cable", "Towers Perrin", "TransDigm Group", "Trinity Industries", "Tropicana Products", "Trianz", "Triumph Group", "Tully's Coffee", "Tupperware Brands", "Twitter", "Ubu Productions", "Ultimate Software", "Under Armour", "Union Pacific Railroad", "Unisys", "United Airlines", "United Parcel Service (UPS)", "United Technologies Corporation", "Universal Studios", "US Airways", "USAA (United Services Automobile Association)", "USRobotics", "U.S. Cellular", "U.S. Steel", "UTStarcom", "Uwajimaya", "Valero Energy Corporation", "Vantec", "The Vanguard Group", "Vaughan & Bushnell Manufacturing", "VECO Corporation", "VF Corporation", "Lee", "Venus Swimwear", "Verbatim Corporation", "Vertex Pharmaceuticals", "Victoria's Secret", "ViewSonic", "VIZ Media", "Vizio", "Vectren", "Verizon Communications", "Verizon Wireless", "Viacom", "Visa Inc.", "Vivitar", "VMware", "Vocera Communications", "Vulcan Corporation", "Wahl Clipper", "Walgreens", "Walmart", "The Walt Disney Company", "Warner Bros.", "Washburn Guitars", "Watco Companies", "W. C. Bradley Co.", "The Weinstein Company", "Welch's", "WellPoint", "Wells Fargo", "Wendy's Company", "Werner Enterprises", "Westat", "West Liberty Foods", "Western Digital", "Westinghouse Digital LLC", "Whataburger", "Wheeling-Pittsburgh Steel", "Whirlpool Corporation", "Whole Foods Market", "Winnebago Industries", "Wizards of the Coast", "W. L. Gore and Associates", "Gore-Tex", "World Airways", "World Financial Group", "W. R. Grace and Company", "WWE", "Wynn Resorts", "Xerox", "Xilinx", "XIM, Inc.", "XPAC", "XPLANE", "Yahoo!", "YASH Technologies", "YRC Worldwide", "Yum! Brands", "Zapata Corporation", "Zappos.com", "Zaxby's", "Zenith Electronics", "ZOMM, LLC", "Zoo York", "Zoom Telephonics", "Zune", ]

class MailHandler(BaseHTTPServer.BaseHTTPRequestHandler):
    def do_GET(self):
        self.send_response(200)
        self.end_headers()
        
        request = urlparse.parse_qs(urlparse.urlparse(self.path).query)
        count = int(request.get('count', [1])[0])
        messages = []
        for i in range(0, count):
          subject = random.choice(SUBJECTS)
          company = random.choice(COMPANIES)
          company_domain = re.sub(r'[^\w]+', '_', company.lower()) + ".com"
          sender = '%s@%s' % (random.choice(SENDERS), company_domain)
          subject = subject % { 'companyname': company }
          body = subject
          
          messages.append({
            'subject': subject,
            'body': body,
            'sender': sender,
            'date': (datetime.datetime.now() - datetime.timedelta(seconds=i)).strftime('%Y-%m-%dT%H:%M:%S')
          })
        
        response_data = {
          'messages': messages,
        }
        
        self.wfile.write(json.dumps(response_data))

if __name__ == '__main__':
    httpd = BaseHTTPServer.HTTPServer(('', 8000), MailHandler)
    try: httpd.serve_forever()
    except KeyboardInterrupt: pass
    httpd.server_close()
